{"paragraphs":[{"title":"Load the data and print number of tweets","text":"%pyspark\ndata = sc.textFile('/home/juande/Desktop/thanksgiving_tweets/tweets.txt')\nprint(data.count())","dateUpdated":"Feb 2, 2016 12:22:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false,"title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1448672479104_1378646192","id":"20151127-170119_1017528142","result":{"code":"SUCCESS","type":"TEXT","msg":"177955\n"},"dateCreated":"Nov 27, 2015 5:01:19 PM","dateStarted":"Feb 2, 2016 12:22:18 PM","dateFinished":"Feb 2, 2016 12:22:19 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53"},{"title":"Word count","text":"%pyspark\n# Word count\nwords = data.flatMap(lambda tweet: tweet.lower().split(' '))\nprint(words.count())\n\n# Get the 20 most common words and their frequency\nwords = words.map(lambda word: (word, 1)).reduceByKey(lambda a, b : a + b)\ntop_words = words.sortBy(lambda x: x[1], ascending = False)\ntop_words = sqlContext.createDataFrame(top_words, ['word', 'count'])\ntop_words.registerTempTable('top')","dateUpdated":"Feb 2, 2016 12:22:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true,"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1448672923047_1339986291","id":"20151127-170843_2136073005","result":{"code":"SUCCESS","type":"TEXT","msg":"2145540\n"},"dateCreated":"Nov 27, 2015 5:08:43 PM","dateStarted":"Feb 2, 2016 12:22:19 PM","dateFinished":"Feb 2, 2016 12:22:22 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:54"},{"title":"Frequency of most common words","text":"%sql\nSELECT * FROM top\nLIMIT 10","dateUpdated":"Feb 2, 2016 12:22:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}},"forceY":false,"lineWithFocus":false},"enabled":true,"editorMode":"ace/mode/sql","title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1449892728057_1138361752","id":"20151211-195848_1005720806","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nthanksgiving\t114556\nhappy\t103026\nrt\t85202\nto\t59143\nthe\t40918\nand\t36614\nyou\t31783\na\t31105\nfor\t28792\nall\t28089\n","comment":"","msgTable":[[{"key":"count","value":"thanksgiving"},{"key":"count","value":"114556"}],[{"value":"happy"},{"value":"103026"}],[{"value":"rt"},{"value":"85202"}],[{"value":"to"},{"value":"59143"}],[{"value":"the"},{"value":"40918"}],[{"value":"and"},{"value":"36614"}],[{"value":"you"},{"value":"31783"}],[{"value":"a"},{"value":"31105"}],[{"value":"for"},{"value":"28792"}],[{"value":"all"},{"value":"28089"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["thanksgiving","114556"],["happy","103026"],["rt","85202"],["to","59143"],["the","40918"],["and","36614"],["you","31783"],["a","31105"],["for","28792"],["all","28089"]]},"dateCreated":"Dec 11, 2015 7:58:48 PM","dateStarted":"Feb 2, 2016 12:22:19 PM","dateFinished":"Feb 2, 2016 12:22:20 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:55"},{"title":"Get top hashtags","text":"%pyspark\nimport re\n\nhashtags = data.flatMap(lambda tweet: tweet.lower().split(' ')).filter(lambda word: word.startswith('#'))\nhashtags = hashtags.map(lambda word: re.sub('[^\\w]$', '', word)).map(lambda hashtag: (hashtag, 1)).reduceByKey(lambda a, b: a + b)\n\n#map to remove the special characters\nprint hashtags.take(5)\n\ntop_hashtags = hashtags.sortBy(lambda x: x[1], ascending = False)\ntop_hashtags = sqlContext.createDataFrame(top_hashtags, ['hashtags', 'count'])\ntop_hashtags.registerTempTable('hashtags')","dateUpdated":"Feb 2, 2016 12:32:46 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1454278820649_-22309201","id":"20160131-142020_771724674","result":{"code":"SUCCESS","type":"TEXT","msg":"[(u'', 84), (u'#thanksgivingdonegood', 1), (u'#carmel', 1), (u'#spaldingu', 2), (u'#alwaysclutch', 1)]\n"},"dateCreated":"Jan 31, 2016 2:20:20 PM","dateStarted":"Feb 2, 2016 12:22:20 PM","dateFinished":"Feb 2, 2016 12:22:24 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"title":"10 most common hashtags","text":"%sql\nSELECT * FROM hashtags\nLIMIT 10","dateUpdated":"Feb 2, 2016 12:22:18 PM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"hashtags","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450566024439_907746029","id":"20151219-150024_1103315146","result":{"code":"SUCCESS","type":"TABLE","msg":"hashtags\tcount\n#thanksgiving\t13716\n#happythanksgiving\t1871\n#thankful\t1350\n#american\t677\n#revealed\t672\n#family\t657\n#imthankfulfor\t504\n#macysparade\t504\n#blessed\t380\n#turkey\t359\n","comment":"","msgTable":[[{"key":"count","value":"#thanksgiving"},{"key":"count","value":"13716"}],[{"value":"#happythanksgiving"},{"value":"1871"}],[{"value":"#thankful"},{"value":"1350"}],[{"value":"#american"},{"value":"677"}],[{"value":"#revealed"},{"value":"672"}],[{"value":"#family"},{"value":"657"}],[{"value":"#imthankfulfor"},{"value":"504"}],[{"value":"#macysparade"},{"value":"504"}],[{"value":"#blessed"},{"value":"380"}],[{"value":"#turkey"},{"value":"359"}]],"columnNames":[{"name":"hashtags","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["#thanksgiving","13716"],["#happythanksgiving","1871"],["#thankful","1350"],["#american","677"],["#revealed","672"],["#family","657"],["#imthankfulfor","504"],["#macysparade","504"],["#blessed","380"],["#turkey","359"]]},"dateCreated":"Dec 19, 2015 3:00:24 PM","dateStarted":"Feb 2, 2016 12:22:23 PM","dateFinished":"Feb 2, 2016 12:22:23 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"title":"What is this \"#revealed\" hashtag?","text":"%pyspark\ntweets_with_revealed = data.filter(lambda tweet: '#revealed:' in tweet.lower())\nprint(tweets_with_revealed.take(3))","dateUpdated":"Feb 2, 2016 12:22:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450566522864_1609251067","id":"20151219-150842_734079098","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'RT @Drudge_Report_: #REVEALED: What Your #Thanksgiving Feast Does To Your Organs... Avg #American Will Consume 4,500 Cals... https://t.co/d\\u2026', u'RT @Drudge_Report_: #REVEALED: What Your #Thanksgiving Feast Does To Your Organs... Avg #American Will Consume 4,500 Cals... https://t.co/d\\u2026', u'RT @Drudge_Report_: #REVEALED: What #Thanksgiving Feast Does To Organs... Avg #American Will Consume 4,500 Cals... https://t.co/dIrvLPnVtQ']\n"},"dateCreated":"Dec 19, 2015 3:08:42 PM","dateStarted":"Feb 2, 2016 12:22:23 PM","dateFinished":"Feb 2, 2016 12:22:24 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"title":"10 most common mentions","text":"%sql \nSELECT * FROM top\nWHERE word LIKE '@%' AND word <> '@'\nLIMIT 10","dateUpdated":"Feb 2, 2016 12:22:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450569207826_-2038522083","id":"20151219-155327_677897364","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\n@onedirection:\t8919\n@obj_3:\t831\n@jensenackles:\t783\n@truthshallbe:\t701\n@shawnmendes:\t684\n@harry_styles:\t666\n@drudge_report_:\t651\n@sincerelytumblr:\t630\n@worldstarfunny:\t578\n@epicurious:\t577\n","comment":"","msgTable":[[{"key":"count","value":"@onedirection:"},{"key":"count","value":"8919"}],[{"value":"@obj_3:"},{"value":"831"}],[{"value":"@jensenackles:"},{"value":"783"}],[{"value":"@truthshallbe:"},{"value":"701"}],[{"value":"@shawnmendes:"},{"value":"684"}],[{"value":"@harry_styles:"},{"value":"666"}],[{"value":"@drudge_report_:"},{"value":"651"}],[{"value":"@sincerelytumblr:"},{"value":"630"}],[{"value":"@worldstarfunny:"},{"value":"578"}],[{"value":"@epicurious:"},{"value":"577"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["@onedirection:","8919"],["@obj_3:","831"],["@jensenackles:","783"],["@truthshallbe:","701"],["@shawnmendes:","684"],["@harry_styles:","666"],["@drudge_report_:","651"],["@sincerelytumblr:","630"],["@worldstarfunny:","578"],["@epicurious:","577"]]},"dateCreated":"Dec 19, 2015 3:53:27 PM","dateStarted":"Feb 2, 2016 12:22:24 PM","dateFinished":"Feb 2, 2016 12:22:24 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"title":"Create new rDD with Retweet status and length of tweet, and second rDD with the words","text":"%pyspark\nretweet_status_and_count = data.map(lambda x: (x, True, len(x)) if x[0:4]=='RT @' else (x, False, len(x)))\nprint(retweet_status_and_count.take(10))","dateUpdated":"Feb 2, 2016 12:22:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true,"editorHide":false,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1448673164771_1683119369","id":"20151127-171244_766598250","result":{"code":"SUCCESS","type":"TEXT","msg":"[(u'RT @vainglorygame: If your turkey is burnt this #Thanksgiving, #BlameZekent! Happy Thanksgiving from everyone at @superevilmegaco.', True, 130), (u'@Harry_Styles Happy Thanksgiving for you too. I love you', False, 56), (u'Happy Thanksgiving from all of us at Skyline! https://t.co/4ZGasuMnOb', False, 69), (u'RT @bummer32: #TedCruz I Wish you and your family Happy Thanksgiving. Next year you will be President.God Bless, we love you. #WakeUpAmeri\\u2026', True, 139), (u'This thanksgiving volunteer to say grace+ use my great grandpas blessing: \"bless the bones + damn the skin, back your ears and cram it in.\"', False, 139), (u'@JacobWhitesides i love you. happy thanksgiving \\U0001f496', False, 49), (u\"RT @HeffronDrive: Happy Thanksgiving!Sending you love from #Italy!I'm thankful for each and every one of you who has supported us along t\\u2026\", True, 138), (u'Fuck thanksgiving dinner, I just need a bottle of jack', False, 54), (u\"To go home and sleep orrrr act like it's thanksgiving? Hmm.\", False, 59), (u'RT @DuFromage78: I quit Twitter  https://t.co/nklj94sg8M', True, 56)]\n"},"dateCreated":"Nov 27, 2015 5:12:44 PM","dateStarted":"Feb 2, 2016 12:22:24 PM","dateFinished":"Feb 2, 2016 12:22:24 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"title":"5 most common retweets","text":"%pyspark\nretweets = retweet_status_and_count.filter(lambda tweet: tweet[1] is True)\nretweets_count = retweets.map(lambda tweet: (tweet[0], 1)).reduceByKey(lambda x, y: x + y).sortBy(lambda x: x[1], ascending = False)\nprint(retweets_count.take(5))","dateUpdated":"Feb 2, 2016 12:22:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450569942072_603417274","id":"20151219-160542_934103075","result":{"code":"SUCCESS","type":"TEXT","msg":"[(u'RT @onedirection: Happy Thanksgiving to all our US fans! https://t.co/VRxM9bxBQq', 8917), (u'RT @OBJ_3: Happy Thanksgiving yall. Have a blessed day!', 830), (u\"RT @JensenAckles: Happy Thanksgiving y'all!!!!  I love PIE!!! https://t.co/MRSBQg513f\", 783), (u'RT @truthshallbe: Happy Thanksgiving to All. May the Lord be with you, and Bless you All, and the family. God Bless our Troops. https://t.c\\u2026', 701), (u'RT @ShawnMendes: GOODMORNING! HAPPY THANKSGIVING! love you guys \\u2764\\ufe0f', 676)]\n"},"dateCreated":"Dec 19, 2015 4:05:42 PM","dateStarted":"Feb 2, 2016 12:22:24 PM","dateFinished":"Feb 2, 2016 12:22:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"title":"Basic stats about the length of the tweets","text":"%pyspark\ntweets_length = sqlContext.createDataFrame(retweet_status_and_count.map(lambda tweet: (tweet[2], )), ['length'])\ntweets_length.describe().show()","dateUpdated":"Feb 2, 2016 12:22:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450570285020_1417052284","id":"20151219-161125_907247112","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+-----------------+\n|summary|           length|\n+-------+-----------------+\n|  count|           177955|\n|   mean|88.13575904020679|\n| stddev|  36.831587617247|\n|    min|                0|\n|    max|              140|\n+-------+-----------------+\n\n"},"dateCreated":"Dec 19, 2015 4:11:25 PM","dateStarted":"Feb 2, 2016 12:22:24 PM","dateFinished":"Feb 2, 2016 12:22:26 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450571134125_-1175756350","id":"20151219-162534_1467880681","dateCreated":"Dec 19, 2015 4:25:34 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:63","dateUpdated":"Feb 2, 2016 12:22:18 PM","dateFinished":"Feb 2, 2016 12:22:25 PM","dateStarted":"Feb 2, 2016 12:22:25 PM","result":{"code":"SUCCESS","type":"TEXT"}}],"name":"Thanksgiving Tweets","id":"2B68QE9WY","angularObjects":{"2B7D2VFTY":[],"2B7DC2HB1":[],"2B7HGCBZP":[],"2B4G89CMZ":[],"2B5A5Y7DE":[],"2B72K3YQ3":[],"2B7ZGP2JH":[],"2B4VAC93A":[],"2B6TQHW52":[],"2B781Y12Z":[],"2B676SEE9":[],"2B6A7E9XA":[],"2B5FD8XB7":[]},"config":{"looknfeel":"default"},"info":{}}