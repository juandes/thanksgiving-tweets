{"paragraphs":[{"title":"Load the data","text":"%pyspark\ndata = sc.textFile('/home/juande/Desktop/thanksgiving_tweets/tweets.txt')\nprint(data.count())","dateUpdated":"Dec 19, 2015 4:46:54 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false,"title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1448672479104_1378646192","id":"20151127-170119_1017528142","result":{"code":"SUCCESS","type":"TEXT","msg":"177955\n"},"dateCreated":"Nov 27, 2015 5:01:19 PM","dateStarted":"Dec 19, 2015 4:37:20 PM","dateFinished":"Dec 19, 2015 4:37:21 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53"},{"title":"Word count","text":"%pyspark\n# Word count\nwords = data.flatMap(lambda tweet: tweet.lower().split(' '))\nprint(words.count())\n\n# Get the 20 most common words and their frequency\nwords = words.map(lambda word: (word, 1)).reduceByKey(lambda a, b : a + b)\ntop_words = words.sortBy(lambda x: x[1], ascending = False)\ntop_words = sqlContext.createDataFrame(top_words, ['word', 'count'])\ntop_words.registerTempTable('top')","dateUpdated":"Dec 19, 2015 4:37:30 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true,"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1448672923047_1339986291","id":"20151127-170843_2136073005","result":{"code":"SUCCESS","type":"TEXT","msg":"2145540\n"},"dateCreated":"Nov 27, 2015 5:08:43 PM","dateStarted":"Dec 19, 2015 4:37:30 PM","dateFinished":"Dec 19, 2015 4:37:33 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:54"},{"text":"%sql\nSELECT * FROM top\nLIMIT 10","dateUpdated":"Dec 19, 2015 4:37:49 PM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}},"forceY":false,"lineWithFocus":false},"enabled":true,"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1449892728057_1138361752","id":"20151211-195848_1005720806","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nthanksgiving\t114556\nhappy\t103026\nrt\t85202\nto\t59143\nthe\t40918\nand\t36614\nyou\t31783\na\t31105\nfor\t28792\nall\t28089\n","comment":"","msgTable":[[{"key":"count","value":"thanksgiving"},{"key":"count","value":"114556"}],[{"value":"happy"},{"value":"103026"}],[{"value":"rt"},{"value":"85202"}],[{"value":"to"},{"value":"59143"}],[{"value":"the"},{"value":"40918"}],[{"value":"and"},{"value":"36614"}],[{"value":"you"},{"value":"31783"}],[{"value":"a"},{"value":"31105"}],[{"value":"for"},{"value":"28792"}],[{"value":"all"},{"value":"28089"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["thanksgiving","114556"],["happy","103026"],["rt","85202"],["to","59143"],["the","40918"],["and","36614"],["you","31783"],["a","31105"],["for","28792"],["all","28089"]]},"dateCreated":"Dec 11, 2015 7:58:48 PM","dateStarted":"Dec 19, 2015 4:37:49 PM","dateFinished":"Dec 19, 2015 4:37:49 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:55","title":"Frequency of most common words"},{"config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450566024439_907746029","id":"20151219-150024_1103315146","dateCreated":"Dec 19, 2015 3:00:24 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:257","text":"%sql\nSELECT * FROM top\nWHERE word LIKE '#%'\nLIMIT 10","dateUpdated":"Dec 19, 2015 4:38:03 PM","dateFinished":"Dec 19, 2015 4:38:03 PM","dateStarted":"Dec 19, 2015 4:38:03 PM","title":"10 most common hashtags","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\n#thanksgiving\t11800\n#happythanksgiving\t1814\n#thankful\t1327\n#thanksgiving!\t813\n#american\t675\n#revealed:\t672\n#family\t632\n#imthankfulfor\t501\n#thanksgiving.\t384\n#thanksgiving,\t380\n","comment":"","msgTable":[[{"key":"count","value":"#thanksgiving"},{"key":"count","value":"11800"}],[{"value":"#happythanksgiving"},{"value":"1814"}],[{"value":"#thankful"},{"value":"1327"}],[{"value":"#thanksgiving!"},{"value":"813"}],[{"value":"#american"},{"value":"675"}],[{"value":"#revealed:"},{"value":"672"}],[{"value":"#family"},{"value":"632"}],[{"value":"#imthankfulfor"},{"value":"501"}],[{"value":"#thanksgiving."},{"value":"384"}],[{"value":"#thanksgiving,"},{"value":"380"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["#thanksgiving","11800"],["#happythanksgiving","1814"],["#thankful","1327"],["#thanksgiving!","813"],["#american","675"],["#revealed:","672"],["#family","632"],["#imthankfulfor","501"],["#thanksgiving.","384"],["#thanksgiving,","380"]]}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450566522864_1609251067","id":"20151219-150842_734079098","dateCreated":"Dec 19, 2015 3:08:42 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:306","dateUpdated":"Dec 19, 2015 4:38:09 PM","dateFinished":"Dec 19, 2015 4:38:09 PM","dateStarted":"Dec 19, 2015 4:38:09 PM","title":"What is this \"#revealed:\" hashtag?","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'RT @Drudge_Report_: #REVEALED: What Your #Thanksgiving Feast Does To Your Organs... Avg #American Will Consume 4,500 Cals... https://t.co/d\\u2026', u'RT @Drudge_Report_: #REVEALED: What Your #Thanksgiving Feast Does To Your Organs... Avg #American Will Consume 4,500 Cals... https://t.co/d\\u2026', u'RT @Drudge_Report_: #REVEALED: What #Thanksgiving Feast Does To Organs... Avg #American Will Consume 4,500 Cals... https://t.co/dIrvLPnVtQ']\n"},"text":"%pyspark\ntweets_with_revealed = data.filter(lambda tweet: '#revealed:' in tweet.lower())\nprint(tweets_with_revealed.take(3))"},{"config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450569207826_-2038522083","id":"20151219-155327_677897364","dateCreated":"Dec 19, 2015 3:53:27 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:367","text":"%sql \nSELECT * FROM top\nWHERE word LIKE '@%'\nLIMIT 10","dateUpdated":"Dec 19, 2015 4:38:14 PM","dateFinished":"Dec 19, 2015 4:38:14 PM","dateStarted":"Dec 19, 2015 4:38:14 PM","title":"10 most common mentions","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\n@onedirection:\t8919\n@\t841\n@obj_3:\t831\n@jensenackles:\t783\n@truthshallbe:\t701\n@shawnmendes:\t684\n@harry_styles:\t666\n@drudge_report_:\t651\n@sincerelytumblr:\t630\n@worldstarfunny:\t578\n","comment":"","msgTable":[[{"key":"count","value":"@onedirection:"},{"key":"count","value":"8919"}],[{"value":"@"},{"value":"841"}],[{"value":"@obj_3:"},{"value":"831"}],[{"value":"@jensenackles:"},{"value":"783"}],[{"value":"@truthshallbe:"},{"value":"701"}],[{"value":"@shawnmendes:"},{"value":"684"}],[{"value":"@harry_styles:"},{"value":"666"}],[{"value":"@drudge_report_:"},{"value":"651"}],[{"value":"@sincerelytumblr:"},{"value":"630"}],[{"value":"@worldstarfunny:"},{"value":"578"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["@onedirection:","8919"],["@","841"],["@obj_3:","831"],["@jensenackles:","783"],["@truthshallbe:","701"],["@shawnmendes:","684"],["@harry_styles:","666"],["@drudge_report_:","651"],["@sincerelytumblr:","630"],["@worldstarfunny:","578"]]}},{"title":"Create new rDD with Retweet status and length of tweet, and second rDD with the words","text":"%pyspark\nretweet_status_and_count = data.map(lambda x: (x, True, len(x)) if x[0:4]=='RT @' else (x, False, len(x)))\nprint(retweet_status_and_count.take(10))","dateUpdated":"Dec 19, 2015 4:38:24 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true,"editorHide":false,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1448673164771_1683119369","id":"20151127-171244_766598250","result":{"code":"SUCCESS","type":"TEXT","msg":"[(u'RT @vainglorygame: If your turkey is burnt this #Thanksgiving, #BlameZekent! Happy Thanksgiving from everyone at @superevilmegaco.', True, 130), (u'@Harry_Styles Happy Thanksgiving for you too. I love you', False, 56), (u'Happy Thanksgiving from all of us at Skyline! https://t.co/4ZGasuMnOb', False, 69), (u'RT @bummer32: #TedCruz I Wish you and your family Happy Thanksgiving. Next year you will be President.God Bless, we love you. #WakeUpAmeri\\u2026', True, 139), (u'This thanksgiving volunteer to say grace+ use my great grandpas blessing: \"bless the bones + damn the skin, back your ears and cram it in.\"', False, 139), (u'@JacobWhitesides i love you. happy thanksgiving \\U0001f496', False, 49), (u\"RT @HeffronDrive: Happy Thanksgiving!Sending you love from #Italy!I'm thankful for each and every one of you who has supported us along t\\u2026\", True, 138), (u'Fuck thanksgiving dinner, I just need a bottle of jack', False, 54), (u\"To go home and sleep orrrr act like it's thanksgiving? Hmm.\", False, 59), (u'RT @DuFromage78: I quit Twitter  https://t.co/nklj94sg8M', True, 56)]\n"},"dateCreated":"Nov 27, 2015 5:12:44 PM","dateStarted":"Dec 19, 2015 4:38:24 PM","dateFinished":"Dec 19, 2015 4:38:24 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450569942072_603417274","id":"20151219-160542_934103075","dateCreated":"Dec 19, 2015 4:05:42 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:415","dateUpdated":"Dec 19, 2015 4:38:30 PM","dateFinished":"Dec 19, 2015 4:38:31 PM","dateStarted":"Dec 19, 2015 4:38:30 PM","title":"5 most common retweets","result":{"code":"SUCCESS","type":"TEXT","msg":"[(u'RT @onedirection: Happy Thanksgiving to all our US fans! https://t.co/VRxM9bxBQq', 8917), (u'RT @OBJ_3: Happy Thanksgiving yall. Have a blessed day!', 830), (u\"RT @JensenAckles: Happy Thanksgiving y'all!!!!  I love PIE!!! https://t.co/MRSBQg513f\", 783), (u'RT @truthshallbe: Happy Thanksgiving to All. May the Lord be with you, and Bless you All, and the family. God Bless our Troops. https://t.c\\u2026', 701), (u'RT @ShawnMendes: GOODMORNING! HAPPY THANKSGIVING! love you guys \\u2764\\ufe0f', 676)]\n"},"text":"%pyspark\nmost_frequent_retweet = retweet_status_and_count.filter(lambda tweet: tweet[1] is True).map(lambda tweet: (tweet[0], 1)).reduceByKey(lambda x, y: x + y).sortBy(lambda x: x[1], ascending = False)\n#x = sorted(most_frequent_retweet, key=most_frequent_retweet.get, reverse = True)\nprint(most_frequent_retweet.take(5))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450570285020_1417052284","id":"20151219-161125_907247112","dateCreated":"Dec 19, 2015 4:11:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:424","dateUpdated":"Dec 19, 2015 4:38:38 PM","dateFinished":"Dec 19, 2015 4:38:39 PM","dateStarted":"Dec 19, 2015 4:38:38 PM","title":"Basic stats about the length of the tweets","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+-----------------+\n|summary|           length|\n+-------+-----------------+\n|  count|           177955|\n|   mean|88.13575904020679|\n| stddev|  36.831587617247|\n|    min|                0|\n|    max|              140|\n+-------+-----------------+\n\n"},"text":"%pyspark\ntweets_length = sqlContext.createDataFrame(retweet_status_and_count.map(lambda tweet: (tweet[2], )), ['length'])\ntweets_length.describe().show()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1450571134125_-1175756350","id":"20151219-162534_1467880681","dateCreated":"Dec 19, 2015 4:25:34 PM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:467"}],"name":"Thanksgiving Tweets","id":"2B68QE9WY","angularObjects":{"2B7D2VFTY":[],"2B7DC2HB1":[],"2B7HGCBZP":[],"2B4G89CMZ":[],"2B5A5Y7DE":[],"2B72K3YQ3":[],"2B7ZGP2JH":[],"2B4VAC93A":[],"2B6TQHW52":[],"2B781Y12Z":[],"2B676SEE9":[],"2B6A7E9XA":[],"2B5FD8XB7":[]},"config":{"looknfeel":"default"},"info":{}}